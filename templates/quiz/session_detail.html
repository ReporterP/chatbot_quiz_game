<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <title>Сессия {{ session.join_code }}</title>
  </head>
  <body>
    <h1>{{ session.quiz.title }} — {{ session.join_code }}</h1>
    <p>Статус: {{ session.get_status_display }}</p>

    <form method="post">
      {% csrf_token %}
      <button type="submit" name="action" value="start">Старт</button>
      <button type="submit" name="action" value="next">Следующий вопрос</button>
      <button type="submit" name="action" value="reveal">Показать ответ</button>
      <button type="submit" name="action" value="end">Завершить</button>
    </form>

    <h2>Текущий вопрос</h2>
    {% if session.current_question %}
      <p>{{ session.current_question.text }}</p>
      <p>Баллы: {{ session.current_question.points }}</p>
      {% if session.current_question_revealed %}
        <p><strong>Правильный ответ:</strong>
          {% for option in session.current_question.options.all %}
            {% if option.is_correct %}
              {{ option.text }}
            {% endif %}
          {% endfor %}
        </p>
      {% else %}
        <p>Ответ скрыт до момента, когда все ответят.</p>
      {% endif %}
    {% else %}
      <p>Вопрос еще не выбран.</p>
    {% endif %}

    <h2>Участники</h2>
    <table border="1" cellpadding="6">
      <thead>
        <tr>
          <th>Имя</th>
          <th>Username</th>
          <th>Баллы</th>
        </tr>
      </thead>
      <tbody>
        {% for participant in participants %}
          <tr>
            <td>{{ participant.first_name }} {{ participant.last_name }}</td>
            <td>{{ participant.username }}</td>
            <td>{{ participant.score }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="3">Нет участников</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <p>
      Экран: <a href="{% url 'session_screen' session.join_code %}" target="_blank">
      открыть публичный экран</a>
    </p>
  </body>
</html>

