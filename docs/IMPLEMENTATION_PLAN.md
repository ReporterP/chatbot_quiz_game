# Quiz Game — План реализации

## Фаза 1: Фундамент ✅
1. **Docker Compose** — postgres, backend, frontend контейнеры.
2. **Go Backend каркас** — Gin-сервер, подключение к PostgreSQL через GORM, автомиграция моделей.
3. **Модели GORM** — Host, Quiz, Category, Question, QuestionImage, Option, Session, Participant, Answer, TelegramUser.

## Фаза 2: Авторизация ведущего ✅
4. **Регистрация / Логин** — bcrypt для паролей, JWT-токены.
5. **Middleware** — проверка JWT, извлечение host_id, проверка Bot API Key.

## Фаза 3: CRUD квизов ✅
6. **Квизы** — создание, редактирование, удаление, список.
7. **Категории** — создание, редактирование, удаление внутри квиза.
8. **Вопросы и варианты** — добавление/редактирование/удаление вопросов с вариантами (2-4, один правильный), настраиваемые цвета.
9. **Изображения** — загрузка картинок к вопросам, lightbox-просмотр.
10. **Drag-n-drop** — изменение порядка категорий и вопросов.
11. **Импорт/экспорт** — JSON и CSV формат.

## Фаза 4: Настройки ведущего ✅
12. **Настройки бота** — ввод/обновление токена и ссылки Telegram-бота.

## Фаза 5: Сессии квиза ✅
13. **Создание сессии** — генерация 6-значного кода, статус `waiting`.
14. **Управление сессией** — reveal (показать ответ), next (следующий вопрос), finish (досрочное завершение).
15. **WebSocket** — real-time обновления для экрана ведущего.
16. **История сессий** — отдельная страница с пагинацией (по 6), результаты, досрочное завершение.

## Фаза 6: Участники и ответы ✅
17. **Присоединение** — по коду сессии + telegram_id + ник (сохранённый в БД).
18. **Отправка ответа** — валидация (сессия в статусе `question`), возможность изменения ответа.
19. **Подсчёт очков** — +100 за правильный ответ + speed bonus (10 — участники × 10) для всех ответивших.

## Фаза 7: React Frontend ✅
20. **Авторизация** — страницы логина/регистрации, хранение JWT.
21. **Дашборд** — список квизов с количеством категорий и вопросов.
22. **Редактор квиза** — категории, вопросы, drag-n-drop, цвета, картинки, экспорт/импорт.
23. **Экран сессии** — лобби (QR-код), игровой экран (вопросы, управление), таблица лидеров (подиум + полная таблица).
24. **История сессий** — пагинация, просмотр результатов, досрочное завершение.
25. **Настройки** — токен и ссылка бота.
26. **Мобильная адаптация** — responsive дизайн через CSS @media queries.

## Фаза 8: Telegram Bot (Go + Webhooks) ✅
27. **BotManager** — динамическое управление несколькими ботами, автоматическая регистрация/удаление webhooks.
28. **Webhook Handler** — приём и маршрутизация обновлений от Telegram по секретному токену.
29. **FSM** — in-memory конечный автомат для состояний участников (ввод кода, ника, в сессии).
30. **Игровой процесс** — получение вопросов, inline-кнопки, отправка ответов, редактирование одного сообщения.
31. **SessionTracker** — polling активных сессий, отправка обновлений (вопросы, результаты, лидерборд).
32. **Профиль участника** — сохранённый ник, история игр, смена ника.

## Фаза 9: Деплой ✅
33. **Docker Compose prod** — bind портов на 127.0.0.1, Nginx reverse proxy.
34. **Скрипт настройки VPS** — Docker, Nginx, Certbot, клонирование репозитория.
35. **CI/CD** — GitHub Actions, SSH deploy, manual trigger (`workflow_dispatch`).
36. **SSL** — Let's Encrypt через Certbot.
